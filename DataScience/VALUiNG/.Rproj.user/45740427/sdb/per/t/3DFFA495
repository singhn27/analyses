{
    "contents" : "# VALUiNG - Veterans Association Lung Cancer Data Analysis using Bayesian Networks\n# Data provided by http://biostat.mc.vanderbilt.edu/wiki/pub/Main/DataSets/valung.csv\n# Input:           http://biostat.mc.vanderbilt.edu/wiki/pub/Main/DataSets/Cvalung.html (description)\n# Output:          Graph relating parameters and some analysis of conditional probabilities\n\n# Libraries #\n\nrequire(bnlearn)\n\n# Analysis #\n\n# Read data from CSV file\ndata <- read.csv(\"valung.csv\", header = TRUE)\n\n# Load data into data frame\ndf <- data.frame(data)\n\n# Transform data in data frame to numeric type\ntfd <- transform(df, therapy = as.numeric(therapy), cell = as.numeric(cell), t = as.numeric(t), dead = as.numeric(dead), kps = as.numeric(kps), diagtime = as.numeric(diagtime), age = as.numeric(age), prior = as.numeric(prior))\n\n# Utilize Hill Climbing algorithm to determine Bayesian Network\nbn_tfd <- hc(tfd)\n\n# Plot Bayesian Network\nplot(bn_tfd, main=\"Bayesian Network of VA Lung data\")\n\n# Fit data to determine conditional probabilities\nfitted <- bn.fit(bn_tfd, data = tfd)\n\n# Some analyses involving conditional probabilities\n# Conditional probability of standard treatment given adenocarcinoma\ncpquery(fitted, event = (therapy < 2), evidence = (cell < 2))\n\n# Conditional probability of test treatment given adenocarcinoma\ncpquery(fitted, event = (therapy > 1), evidence = (cell < 2))\n\n# Conditional probability of standard treatment given large cell carcinoma\ncpquery(fitted, event = (therapy < 2), evidence = (cell > 1 & cell < 3))\n\n# Conditional probability of test treatment given large cell carcinoma\ncpquery(fitted, event = (therapy > 1), evidence = (cell > 1 & cell < 3))\n\n# Conditional probability of standard treatment given small cell carcinoma\ncpquery(fitted, event = (therapy < 2), evidence = (cell > 2 & cell < 4))\n\n# Conditional probability of test treatment given small cell carcinoma\ncpquery(fitted, event = (therapy > 1), evidence = (cell > 2 & cell < 4))\n\n# Conditional probability of standard treatment given squamous cell carcinoma\ncpquery(fitted, event = (therapy < 2), evidence = (cell > 3))\n\n# Conditional probability of test treatment given squamous cell carcinoma\ncpquery(fitted, event = (therapy > 1), evidence = (cell > 3))\n\n# Conditional probability of poor KPS given prior treatment\ncpquery(fitted, event = (kps < 50), evidence = (prior > 1))\n\n# Conditional probability of poor KPS given no prior treatment\ncpquery(fitted, event = (kps < 50), evidence = (prior < 2))\n\n# Conditional probability of lasting longer than 90 days in treatment\n# given that the treatment starts within 1 month of diagnosis\ncpquery(fitted, event = (t > 90), evidence = (diagtime < 2))\n\n# Conditional probability of lasting longer than 90 days in treatment\n# given that the treatment starts within 6 months of diagnosis\ncpquery(fitted, event = (t > 90), evidence = (diagtime < 7))\n\n# Conditional probability of lasting longer than 90 days in treatment\n# given that the treatment starts within 1 year of diagnosis\ncpquery(fitted, event = (t > 90), evidence = (diagtime < 13))\n\n# Conditional probability of lasting longer than 90 days in treatment\n# given that the treatment starts within 2 years of diagnosis\ncpquery(fitted, event = (t > 90), evidence = (diagtime < 25))\n\n# Conditional probability of lasting longer than 180 days in treatment\n# given that the treatment starts within 1 month of diagnosis\ncpquery(fitted, event = (t > 180), evidence = (diagtime < 2))\n\n# Conditional probability of lasting longer than 180 days in treatment\n# given that the treatment starts within 6 months of diagnosis\ncpquery(fitted, event = (t > 180), evidence = (diagtime < 7))\n\n# Conditional probability of lasting longer than 180 days in treatment\n# given that the treatment starts within 1 year of diagnosis\ncpquery(fitted, event = (t > 180), evidence = (diagtime < 13))\n\n# Conditional probability of lasting longer than 180 days in treatment\n# given that the treatment starts within 2 years of diagnosis\ncpquery(fitted, event = (t > 180), evidence = (diagtime < 25))\n\n# Conditional probability of lasting longer than 360 days in treatment\n# given that the treatment starts within 1 month of diagnosis\ncpquery(fitted, event = (t > 360), evidence = (diagtime < 2))\n\n# Conditional probability of lasting longer than 360 days in treatment\n# given that the treatment starts within 6 months of diagnosis\ncpquery(fitted, event = (t > 360), evidence = (diagtime < 7))\n\n# Conditional probability of lasting longer than 360 days in treatment\n# given that the treatment starts within 1 year of diagnosis\ncpquery(fitted, event = (t > 360), evidence = (diagtime < 13))\n\n# Conditional probability of lasting longer than 360 days in treatment\n# given that the treatment starts within 2 years of diagnosis\ncpquery(fitted, event = (t > 360), evidence = (diagtime < 25))\n\n# Create histogram of patient age\nhist(tfd$age, col=\"blue\", main=\"Patient Age Breakdown\", xlab=\"Age (Years)\")\n\n# Create a dark blue to light blue gradient,\n# used to clarify and beautify the plot below\ngradient_blue <- colorRampPalette(c(\"darkblue\", \"lightblue\"))\n\n# Plot patient KPS by diagnosis time\nplot(tfd$kps, tfd$diagtime, col=gradient_blue(5)[findInterval(tfd$diagtime, seq(3:6))], main=\"Patient Karnofsky Performance Status by Diagnosis Time\", ylab=\"Time from Diagnosis to Entry (Months)\", xlab=\"Karnofsky Performance Status (0-99)\")\n",
    "created" : 1424316179301.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4032645029",
    "id" : "3DFFA495",
    "lastKnownWriteTime" : 1424321887,
    "path" : "C:/Users/singhn27/Dropbox/Dev/Bayesian Networks/VALUiNG/VALUiNG.R",
    "project_path" : "VALUiNG.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}